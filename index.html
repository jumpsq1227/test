<!DOCTYPE html>
<html lang="ja">
<head><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="UTF-8">
<title>A1 German Quiz</title>
<style>
  #options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    max-width: 600px;
    margin-top: 10px;
  }
  #options button {
    padding: 25px;
    font-size: 1.0rem;
    cursor: pointer;
    height: 60px;
    border-radius: 8px;
    border: 1px solid #333;
    transition: background-color 0.3s;
  }
  #startBtn {
    font-size: 1.5rem;   /* æ–‡å­—ã‚µã‚¤ã‚ºã‚’å¤§ãã */
    padding: 15px 30px;  /* ä¸Šä¸‹15pxã€å·¦å³30pxã®ä½™ç™½ */
    height: 70px;         /* ãƒœã‚¿ãƒ³é«˜ã• */
    width: 100%;          /* ç”»é¢å¹…ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
    border-radius: 10px;  /* è§’ä¸¸ */
    border: 1px solid #333;
    cursor: pointer;
    margin-bottom: 20px;  /* ä¸‹ã®ä½™ç™½ */
    background-color: #4626d4;
    color: white;
    transition: background-color 0.3s;
  }
  #startBtn:hover {
    background-color: #45a049; /* ãƒ›ãƒãƒ¼ã§å°‘ã—è‰²ã‚’å¤‰åŒ– */
  }
  #quiz {
    font-size: 1.6rem;       /* æ–‡å­—ã‚µã‚¤ã‚ºã‚’å¤§ãã */
    font-weight: bold;       /* å¤ªå­— */
    margin-bottom: 15px;     /* ä¸‹ã«ä½™ç™½ */
  }
</style>
</head>
<body>
<h1>A1 German Quiz</h1>

<label><input type="radio" name="mode" value="jp2de" checked> æ—¥æœ¬èª â†’ ãƒ‰ã‚¤ãƒ„èª</label>
<label><input type="radio" name="mode" value="de2jp"> ãƒ‰ã‚¤ãƒ„èª â†’ æ—¥æœ¬èª</label>
<br><br>

<button id="startBtn">ã‚¯ã‚¤ã‚ºå‡ºé¡Œ</button>
<div id="quiz"></div>
<div id="options"></div>
<div id="result"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
let words = [];

// CSVèª­ã¿è¾¼ã¿
async function loadCSV() {
  try {
    const response = await fetch("words.csv");
    const text = await response.text();
    const result = Papa.parse(text, {header:true, skipEmptyLines:true});
    words = result.data;
    console.log("Loaded words:", words);
  } catch (error) {
    console.error("CSVèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", error);
  }
}

// ã‚·ãƒ£ãƒƒãƒ•ãƒ«é–¢æ•°
function shuffle(array) { return array.sort(()=>Math.random()-0.5); }

// é¸æŠè‚¢ç”Ÿæˆ
function generateOptions(correct, key, articleKey) {
  let opts = [correct];
  while (opts.length < 4) {
    const rand = words[Math.floor(Math.random()*words.length)];
    let val;
    if(key==="Wort") val = `${rand[articleKey]} ${rand[key]}`.trim();
    else val = rand[key];
    if(!opts.includes(val)) opts.push(val);
  }
  return shuffle(opts);
}

// ã‚¯ã‚¤ã‚ºé–‹å§‹
function startQuiz() {
  if(words.length < 4) { alert("words.csv ã«æœ€ä½4å˜èªå¿…è¦ã§ã™"); return; }

  const mode = document.querySelector("input[name='mode']:checked").value;
  const randomWord = words[Math.floor(Math.random()*words.length)];

  let question, correctAnswer, options;
  if(mode==="jp2de"){
    question = `${randomWord.Translation}`;
    correctAnswer = `${randomWord.Artikel} ${randomWord.Wort}`.trim();
    options = generateOptions(correctAnswer,"Wort","Artikel");
  } else {
    question = `${randomWord.Artikel} ${randomWord.Wort}`;
    correctAnswer = randomWord.Translation;
    options = generateOptions(correctAnswer,"Translation");
  }

  document.getElementById("quiz").textContent = question;
  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";
  options.forEach(opt=>{
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = ()=>checkAnswer(btn,opt,correctAnswer);
    optionsDiv.appendChild(btn);
  });

  document.getElementById("result").textContent = "";
}

// å›ç­”ãƒã‚§ãƒƒã‚¯ï¼ˆè‰²å¤‰æ›´ï¼‰
function checkAnswer(btn, answer, correct) {
  if(answer===correct){
    btn.style.backgroundColor = "lightgreen";
    document.getElementById("result").textContent = "æ­£è§£ğŸ‰";
  } else {
    btn.style.backgroundColor = "salmon";
    document.getElementById("result").textContent = `ä¸æ­£è§£ğŸ˜¥ æ­£ã—ã„ç­”ãˆã¯ã€Œ${correct}ã€ã§ã™ã€‚`;
  }
}

// ã‚¤ãƒ™ãƒ³ãƒˆ
document.getElementById("startBtn").addEventListener("click", startQuiz);
loadCSV();
</script>
</body>
</html>
