<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>A1 German Quiz</title>
</head>
<body>
  <h1>A1 German Quiz</h1>
  <button id="startBtn">クイズ開始</button>
  <div id="quiz"></div>
  <div id="result"></div>

  <script>
    let words = [];

    // CSVを読み込む関数
    async function loadCSV() {
      try {
        const response = await fetch("words.csv");
        const text = await response.text();
        words = parseCSV(text);
        console.log("Loaded words:", words);
      } catch (error) {
        console.error("CSV読み込みエラー:", error);
      }
    }

    // CSVパース関数
    function parseCSV(text) {
      const lines = text.trim().split("\n");
      const headers = lines[0].split(",");
      return lines.slice(1).map(line => {
        const values = line.split(",");
        let obj = {};
        headers.forEach((h, i) => {
          obj[h.trim()] = values[i] ? values[i].trim() : "";
        });
        return obj;
      });
    }

    // クイズを開始する関数
    function startQuiz() {
      if (words.length === 0) {
        alert("単語リストが読み込めていません。words.csv を確認してください。");
        return;
      }

      const randomWord = words[Math.floor(Math.random() * words.length)];
      const quizDiv = document.getElementById("quiz");
      quizDiv.innerHTML = `
        <p><strong>${randomWord.German}</strong> の意味は？（品詞: ${randomWord.PartOfSpeech}, 冠詞: ${randomWord.Article}）</p>
        <input type="text" id="answer" placeholder="意味を入力">
        <button onclick="checkAnswer('${randomWord.Meaning}')">回答</button>
      `;
    }

    // 回答チェック
    function checkAnswer(correct) {
      const answer = document.getElementById("answer").value.trim();
      const resultDiv = document.getElementById("result");
      if (answer === correct) {
        resultDiv.textContent = "正解！";
      } else {
        resultDiv.textContent = `不正解。正しい答えは「${correct}」です。`;
      }
    }

    document.getElementById("startBtn").addEventListener("click", startQuiz);

    // ページ読み込み時にCSVをロード
    loadCSV();
  </script>
</body>
</html>
