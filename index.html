
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>A1 German Random Quiz</title>
  <style>
    body{font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", "Hiragino Kaku Gothic ProN", "Yu Gothic", Arial; padding:20px; background:#f7f7fb; color:#111}
    .card{max-width:820px;margin:18px auto;padding:24px;border-radius:12px;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
    h1{margin:0 0 12px;font-size:20px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    button{padding:8px 12px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer}
    button.primary{background:#0066cc;color:#fff;border-color:#0066cc}
    .question{font-size:24px;margin:18px 0}
    .answer{margin:12px 0;padding:12px;border-radius:8px;background:#f0f6ff;display:none}
    .meta{color:#666;font-size:13px;margin-top:8px}
    .choice-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
    .choice{padding:10px;border-radius:8px;border:1px solid #ddd;background:#fafafa;cursor:pointer;text-align:center}
    .correct{background:#e6f8ec;border-color:#8bd89a}
    .wrong{background:#ffecec;border-color:#ff9a9a}
    footer{font-size:13px;color:#666;margin-top:14px;text-align:center}
    label{display:flex;align-items:center;gap:8px}
    input[type="checkbox"]{width:18px;height:18px}
    .score{font-weight:600;margin-left:8px}
  </style>
</head>
<body>
  <div class="card">
    <h1>ドイツ語 A1 ランダム出題アプリ</h1>
    <div class="controls">
      <label><input type="checkbox" id="jpFirst"> 日本語 → ドイツ語</label>
      <label><input type="checkbox" id="useChoices" checked> 選択肢モード（4択）</label>
      <label><input type="checkbox" id="autoSpeak"> 回答表示時に発音</label>
      <button id="nextBtn" class="primary">問題を出す</button>
      <button id="showBtn">答えを表示</button>
      <button id="speakBtn">発音</button>
      <div style="margin-left:auto">正答: <span id="correctCount">0</span> / <span id="totalCount">0</span></div>
    </div>

    <div class="question" id="question">「問題を出す」を押してください</div>

    <div class="choice-grid" id="choices" style="display:none"></div>
    <div class="answer" id="answer"></div>
    <div class="meta" id="meta"></div>

    <footer>データはアプリ内に組み込み済み。旅行で使うフレーズを優先しています。</footer>
  </div>

<script>
// A1で頻出の語句・フレーズ一覧（例：German, Japanese）
const items = [
{de:"Guten Tag", jp:"こんにちは / こんにちは（フォーマル）"},
{de:"Hallo", jp:"やあ / こんにちは（カジュアル）"},
{de:"Guten Morgen", jp:"おはようございます"},
{de:"Guten Abend", jp:"こんばんは"},
{de:"Tschüss", jp:"さようなら（カジュアル）"},
{de:"Auf Wiedersehen", jp:"さようなら（フォーマル）"},
{de:"Wie heißen Sie?", jp:"お名前は何ですか？（フォーマル）"},
{de:"Wie heißt du?", jp:"あなたの名前は？（カジュアル）"},
{de:"Ich heiße ...", jp:"私は〜と申します"},
{de:"Freut mich", jp:"はじめまして / お会いできて嬉しいです"},
{de:"Danke", jp:"ありがとう"},
{de:"Vielen Dank", jp:"どうもありがとうございます"},
{de:"Bitte", jp:"どういたしまして / どうぞ（依頼）"},
{de:"Entschuldigung", jp:"すみません / 失礼します"},
{de:"Es tut mir leid", jp:"申し訳ありません"},
{de:"Ja", jp:"はい"},
{de:"Nein", jp:"いいえ"},
{de:"Vielleicht", jp:"たぶん / かもしれない"},
{de:"Ich spreche nur ein bisschen Deutsch", jp:"私はドイツ語が少ししか話せません"},
{de:"Sprechen Sie Englisch?", jp:"英語を話せますか？（フォーマル）"},
{de:"Wo ist die Toilette?", jp:"トイレはどこですか？"},
{de:"Wo ist der Bahnhof?", jp:"駅はどこですか？"},
{de:"Wie komme ich zum ... ?", jp:"... へはどうやって行きますか？"},
{de:"Ein Ticket nach Zürich, bitte", jp:"チューリッヒ行きの切符をください"},
{de:"Wie viel kostet das?", jp:"これはいくらですか？"},
{de:"Haben Sie das in Größe M?", jp:"これのMサイズはありますか？"},
{de:"Ich möchte bezahlen", jp:"お会計をお願いします"},
{de:"Die Rechnung, bitte", jp:"お勘定をお願いします"},
{de:"Ein Kaffee, bitte", jp:"コーヒーを一つください"},
{de:"Ein Bier, bitte", jp:"ビールを一杯ください"},
{de:"Ich hätte gern ...", jp:"〜をください（レストランで丁寧に）"},
{de:"Ich habe eine Reservierung", jp:"予約しています"},
{de:"Ich möchte ein Zimmer buchen", jp:"部屋を予約したいです"},
{de:"Wann ist der Check-in?", jp:"チェックインは何時ですか？"},
{de:"Ich bin allergisch gegen ...", jp:"〜にアレルギーがあります"},
{de:"Mir ist schlecht", jp:"気分が悪いです"},
{de:"Können Sie mir helfen?", jp:"手伝っていただけますか？"},
{de:"Ich habe meinen Pass verloren", jp:"パスポートをなくしました"},
{de:"Rufen Sie bitte die Polizei!", jp:"警察を呼んでください！"},
{de:"Wie spät ist es?", jp:"何時ですか？"},
{de:"Links", jp:"左"},
{de:"Rechts", jp:"右"},
{de:"Geradeaus", jp:"まっすぐ"},
{de:"Eins", jp:"1"},
{de:"Zwei", jp:"2"},
{de:"Drei", jp:"3"},
{de:"Vier", jp:"4"},
{de:"Fünf", jp:"5"},
{de:"Sechs", jp:"6"},
{de:"Sieben", jp:"7"},
{de:"Acht", jp:"8"},
{de:"Neun", jp:"9"},
{de:"Zehn", jp:"10"},
{de:"Ich verstehe nicht", jp:"わかりません"},
{de:"Können Sie das wiederholen?", jp:"もう一度言っていただけますか？"},
{de:"Langsam, bitte", jp:"ゆっくりお願いします"},
{de:"Ich bin aus Japan", jp:"私は日本出身です"},
{de:"Ich habe eine Frage", jp:"質問があります"},
{de:"Was empfehlen Sie?", jp:"おすすめは何ですか？"}
];

let correct=0, total=0;
let current=null;

function randInt(n){ return Math.floor(Math.random()*n); }

function makeQuestion(){
  const jpFirst = document.getElementById('jpFirst').checked;
  const useChoices = document.getElementById('useChoices').checked;
  current = items[randInt(items.length)];
  total++;
  document.getElementById('totalCount').textContent = total;
  const questionEl = document.getElementById('question');
  const answerEl = document.getElementById('answer');
  const choicesEl = document.getElementById('choices');
  answerEl.style.display='none';
  choicesEl.style.display = 'none';
  choicesEl.innerHTML='';
  document.getElementById('meta').textContent='';
  if(jpFirst){
    questionEl.textContent = "日本語: " + current.jp;
    questionEl.dataset.expected = current.de;
    if(useChoices){
      showChoices('de');
    }
  } else {
    questionEl.textContent = "Deutsch: " + current.de;
    questionEl.dataset.expected = current.jp;
    if(useChoices){
      showChoices('jp');
    }
  }
}

function showChoices(lang){
  const choicesEl = document.getElementById('choices');
  choicesEl.style.display='grid';
  // correct plus 3 distractors
  const opts = new Set();
  opts.add(current);
  while(opts.size<4){
    opts.add(items[randInt(items.length)]);
  }
  const arr = Array.from(opts);
  // shuffle
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  arr.forEach(opt=>{
    const div = document.createElement('div');
    div.className='choice';
    div.textContent = (lang==='de')?opt.de:opt.jp;
    div.onclick = ()=>{
      handleChoice(div, opt, lang);
    };
    choicesEl.appendChild(div);
  });
}

function handleChoice(div, opt, lang){
  const expected = (lang==='de')?current.de:current.jp;
  const answerEl = document.getElementById('answer');
  if(opt === current){
    div.classList.add('correct');
    answerEl.textContent = '正解！;
    correct++;
    document.getElementById('correctCount').textContent = correct;
  } else {
    div.classList.add('wrong');
    answerEl.textContent = '不正解。正解は: ' + current.jp;
  }
  answerEl.style.display='block';
  if(document.getElementById('autoSpeak').checked) speak(current.de);
}

function showAnswer(){
  if(!current) return;
  const q = document.getElementById('question');
  const answerEl = document.getElementById('answer');
  if(q.dataset.expected){
    answerEl.textContent = '答え: ' + q.dataset.expected;
  } else {
    answerEl.textContent = '答え: ' + (document.getElementById('jpFirst').checked ? current.de + ' — ' + current.jp : current.jp + ' — ' + current.de);
  }
  answerEl.style.display='block';
  if(document.getElementById('autoSpeak').checked) speak(current.de);
}

function speak(text){
  if(!('speechSynthesis' in window)) return;
  const ut = new SpeechSynthesisUtterance(text);
  // try to set German voice
  const voices = speechSynthesis.getVoices();
  let v = voices.find(x=>x.lang && x.lang.startsWith('de')) || voices[0];
  if(v) ut.voice = v;
  ut.lang='de-DE';
  speechSynthesis.cancel();
  speechSynthesis.speak(ut);
}

document.getElementById('nextBtn').addEventListener('click', makeQuestion);
document.getElementById('showBtn').addEventListener('click', showAnswer);
document.getElementById('speakBtn').addEventListener('click', ()=>{ if(current) speak(current.de); });
</script>
</body>
</html>
